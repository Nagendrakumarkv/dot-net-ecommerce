@model FlipkartClone.Models.ViewModels.CheckoutViewModel

<div class="container mt-4 mb-5">
    <div class="row">
        <div class="col-md-8">
            <h4 class="mb-3 bg-white p-3 shadow-sm text-muted">
                <span class="badge bg-primary me-2">1</span> Select Delivery Address
            </h4>

            <form asp-action="Payment" method="get"> 
                
                @if (!Model.Addresses.Any())
                {
                    <div class="alert alert-warning">
                        No addresses found! 
                        <a asp-controller="Address" asp-action="Create" class="fw-bold">Add New Address</a>
                    </div>
                }
                else
                {
                    @foreach (var addr in Model.Addresses)
                    {
                        <div class="card mb-3 shadow-sm border-0">
                            <div class="card-body">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="selectedAddressId" value="@addr.Id" id="addr_@addr.Id" checked>
                                    
                                    <label class="form-check-label w-100" for="addr_@addr.Id">
                                        <div class="d-flex justify-content-between">
                                            <span class="fw-bold">@addr.FullName <span class="badge bg-light text-dark border ms-2">HOME</span></span>
                                            <span class="fw-bold">@addr.PhoneNumber</span>
                                        </div>
                                        <p class="text-muted small mt-1 mb-0">
                                            @addr.StreetAddress, @addr.City, @addr.State - <strong>@addr.ZipCode</strong>
                                        </p>
                                    </label>
                                </div>
                            </div>
                        </div>
                    }
                    
                    <div class="text-end mt-2 mb-4">
                        <a asp-controller="Address" asp-action="Create" class="btn btn-outline-primary btn-sm">+ Add Another Address</a>
                    </div>
                    
                    <h4 class="mb-3 bg-white p-3 shadow-sm text-muted">
                        <span class="badge bg-primary me-2">2</span> Order Summary
                    </h4>
                    
                    <div class="bg-white p-3 shadow-sm mb-3">
                        @foreach(var item in Model.CartItems)
                        {
                            <div class="d-flex align-items-center mb-3 border-bottom pb-2">
                                <img src="@item.ImageUrl" style="width: 60px; height: 60px; object-fit: contain;" class="me-3">
                                <div>
                                    <h6 class="mb-1">@item.ProductName</h6>
                                    <span class="text-muted small">Qty: @item.Quantity</span>
                                    <span class="fw-bold ms-3">₹@item.Total</span>
                                </div>
                            </div>
                        }
                    </div>

                    <button type="submit" class="btn btn-lg w-100 text-white fw-bold shadow-sm" style="background-color: #fb641b; border-radius: 2px;">
                        CONTINUE TO PAYMENT
                    </button>
                }
            </form>
        </div>

        <div class="col-md-4">
            <div class="bg-white shadow-sm p-3 position-sticky" style="top: 80px;">
                <h6 class="text-muted border-bottom pb-2">PRICE DETAILS</h6>
                <div class="d-flex justify-content-between mb-2">
                    <span>Price (@Model.CartItems.Sum(x => x.Quantity) items)</span>
                    <span>₹@Model.GrandTotal</span>
                </div>
                <div class="d-flex justify-content-between mb-3">
                    <span>Delivery Charges</span>
                    <span class="text-success">Free</span>
                </div>
                <div class="d-flex justify-content-between border-top py-3">
                    <span class="fw-bold fs-5">Total Payable</span>
                    <span class="fw-bold fs-5">₹@Model.GrandTotal</span>
                </div>
            </div>
            
            <div class="mt-3 text-center">
                <img src="https://static-assets-web.flixcart.com/fk-p-linchpin-web/fk-cp-zion/img/shield_b33d0c.svg" height="30" />
                <span class="small text-muted ms-2">Safe and Secure Payments. 100% Authentic products.</span>
            </div>
        </div>
    </div>
</div>